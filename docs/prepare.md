# Подготовка артефактов Guido к распространению

Этот документ описывает шаги для сборки артефактов "Guido" для различных способов запуска. Все результаты сборки будут помещены в каталог `build_output/`.

## 1. Подготовка "полезной нагрузки" (`guido_payload`)

"Полезная нагрузка" — это каталог `guido_payload/`, содержащий основной скрипт `guido.sh` и все его библиотеки. Убедитесь, что все изменения в этом каталоге сохранены и протестированы перед сборкой.

## 2. Сборка артефактов с помощью `build_installer.sh`

Скрипт `build_installer.sh` является центральным инструментом для создания всех артефактов. Он имеет два основных, **взаимоисключающих** режима работы.

### Режим 1: Сборка для Bootstrap-метода (Рекомендуемый)

Это режим **по умолчанию**. Он создает артефакты, предназначенные для надежной и "стелс"-доставки через терминал с использованием инструкций из файла `docs/bootstrap.md`.

1.  **Запустите скрипт без дополнительных флагов:**
    ```bash
    ./build_installer.sh
    ```
    *   **Результат:** В каталоге `build_output/` будет создан файл `guido_installer.oneliner.txt`. Он содержит всю полезную нагрузку, сжатую `xz` и закодированную в Base64.

2.  **(Рекомендуется) Разбиение на части:**
    Для надежной передачи через любой терминал, разбейте однострочник на части с помощью флага `--split-oneliner`.
    ```bash
    ./build_installer.sh --split-oneliner 32768
    ```
    *   **Результат:**
        *   В `build_output/` будет создан полный однострочник `guido_installer.oneliner.txt`.
        *   Дополнительно будут созданы файлы частей: `oneliner_part_000.b64part`, `oneliner_part_001.b64part` и т.д.
        *   **Именно эти файлы-части вы будете использовать для доставки, следуя инструкциям из файла `docs/bootstrap.md`.**

### Режим 2: Сборка Legacy-установщика (`guido_installer.sh`)

Этот режим используется, если вам нужен единый исполняемый `.sh` файл, который удобно копировать целиком, и вы не планируете использовать `bootstrap`-метод.

1.  **Запустите скрипт с флагом `--legacy-installer`:**
    ```bash
    ./build_installer.sh --legacy-installer
    ```
    *   **Результат:** В каталоге `build_output/` будет создан самодостаточный скрипт `guido_installer.sh`.

### Итог: Что где лежит?

*   **Для Bootstrap-метода** (запуск по умолчанию):
    *   `build_output/guido_installer.oneliner.txt` (полная Base64-строка)
    *   `build_output/oneliner_part_*` (части для копирования)
*   **Для Legacy-метода** (запуск с `--legacy-installer`):
    *   `build_output/guido_installer.sh` (единый исполняемый файл)